<% layout('layouts/boilerplate') %>

<h2>Panel de Control del Administrador</h2>

<div class="row mb-4">
  <div class="col-md-4">
    <div class="card text-white bg-primary">
      <div class="card-body">
        <h5 class="card-title">Testers</h5>
        <p class="card-text display-4"><%= stats.users %></p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-white bg-success">
      <div class="card-body">
        <h5 class="card-title">Casos de Prueba</h5>
        <p class="card-text display-4"><%= stats.testCases %></p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card text-white bg-info">
      <div class="card-body">
        <h5 class="card-title">Flujos</h5>
        <p class="card-text display-4"><%= stats.flows %></p>
      </div>
    </div>
  </div>
</div>

<h4>Envios Recientes</h4>
<table class="table table-striped">
  <thead>
    <tr>
      <th>Fecha</th>
      <th>Usuario</th>
      <th>Caso de Prueba</th>
      <th>Estado</th>
      <th>Puntos</th>
    </tr>
  </thead>
  <tbody>
    <% recentSubmissions.forEach(sub => { %>
      <tr>
        <td><%= sub.createdAt.toLocaleDateString() %></td>
        <td><%= sub.user ? sub.user.username : 'N/A' %></td>
        <td><%= sub.testCase ? sub.testCase.title : 'N/A' %></td>
        <td class="status-<%= sub.status %>"><%= sub.status === 'passed' ? 'Aprobado' : 'Fallido' %></td>
        <td><%= sub.pointsEarned %></td>
      </tr>
    <% }) %>
  </tbody>
</table>
